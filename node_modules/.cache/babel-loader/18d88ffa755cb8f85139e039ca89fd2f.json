{"remainingRequest":"C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\public\\SSWebChannel.js","dependencies":[{"path":"C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\public\\SSWebChannel.js","mtime":1747702259176},{"path":"C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\babel.config.js","mtime":1747014229538},{"path":"C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747302828451},{"path":"C:\\Users\\sun.ruiqi\\LAE_dashboard\\code\\node_modules\\babel-loader\\lib\\index.js","mtime":1747302829587}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5tYXAuanMiOwp2YXIgUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMgPSB7CiAgc2lnbmFsOiAxLAogIHByb3BlcnR5VXBkYXRlOiAyLAogIGluaXQ6IDMsCiAgaWRsZTogNCwKICBkZWJ1ZzogNSwKICBpbnZva2VNZXRob2Q6IDYsCiAgY29ubmVjdFRvU2lnbmFsOiA3LAogIGRpc2Nvbm5lY3RGcm9tU2lnbmFsOiA4LAogIHNldFByb3BlcnR5OiA5LAogIHJlc3BvbnNlOiAxMCwKICBpbnZva2VKU01ldGhvZDogMTEKfTsKdmFyIE1lc3NhZ2VRdWV1ZSA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLm1heENvdW50ID0gMjA0ODsKICB0aGlzLnF1ZXVlID0gW107CiAgdGhpcy5xdWV1ZS5sZW5ndGggPSB0aGlzLm1heENvdW50OwogIHRoaXMuY3VycmVudFNldElkeCA9IDA7CiAgdGhpcy5jdXJyZW50R2V0SWR4ID0gMDsKICB0aGlzLmNvdW50ID0gMDsKICB0aGlzLmVucXVldWUgPSBkYXRhID0+IHsKICAgIHRoaXMucXVldWVbdGhpcy5jdXJyZW50U2V0SWR4XSA9IGRhdGE7CiAgICArK3RoaXMuY291bnQ7CiAgICB0aGlzLmN1cnJlbnRTZXRJZHggPSAodGhpcy5jdXJyZW50U2V0SWR4ICsgMSkgJSB0aGlzLm1heENvdW50OwogIH07CiAgdGhpcy5kZXF1ZXVlID0gKCkgPT4gewogICAgaWYgKHRoaXMuY291bnQgPD0gMCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQogICAgbGV0IGRhdGEgPSB0aGlzLnF1ZXVlW3RoaXMuY3VycmVudEdldElkeF07CiAgICAtLXRoaXMuY291bnQ7CiAgICB0aGlzLmN1cnJlbnRHZXRJZHggPSAodGhpcy5jdXJyZW50R2V0SWR4ICsgMSkgJSB0aGlzLm1heENvdW50OwogICAgcmV0dXJuIGRhdGE7CiAgfTsKICB0aGlzLmRlcXVldWVBbGwgPSAoKSA9PiB7CiAgICBpZiAodGhpcy5jb3VudCkgewogICAgICBsZXQgcmVzdWx0ID0gJ1snOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY291bnQ7IGkrKykgewogICAgICAgIGlmIChpID4gMCkgcmVzdWx0ICs9ICcsJzsKICAgICAgICByZXN1bHQgKz0gdGhpcy5kZXF1ZXVlKCk7CiAgICAgIH0KICAgICAgcmVzdWx0ICs9ICddJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0gZWxzZSByZXR1cm4gJyc7CiAgfTsKfTsKdmFyIFdlYkNoYW5uZWxTb2NrZXQgPSBmdW5jdGlvbiAoKSB7CiAgdGhpcy5xdWV1ZSA9IG5ldyBNZXNzYWdlUXVldWUoKTsKICB0aGlzLmdldE1lc3NhZ2UgPSAoKSA9PiB7CiAgICByZXR1cm4gdGhpcy5xdWV1ZS5kZXF1ZXVlQWxsKCk7CiAgfTsKICB0aGlzLmdldEN1cnJlbnRHZXRJZHggPSAoKSA9PiB7CiAgICByZXR1cm4gdGhpcy5xdWV1ZS5jdXJyZW50R2V0SWR4OwogIH07CiAgdGhpcy5zZW5kID0gbWVzc2FnZSA9PiB7CiAgICB0aGlzLnF1ZXVlLmVucXVldWUobWVzc2FnZSk7CiAgfTsKICB0aGlzLmV2ZW50ID0gewogICAgZGF0YTogdW5kZWZpbmVkCiAgfTsKICB0aGlzLnJlY2VpdmUgPSBtZXNzYWdlID0+IHsKICAgIGlmICh0aGlzLm9ubWVzc2FnZSkgewogICAgICB0aGlzLmV2ZW50LmRhdGEgPSBtZXNzYWdlOwogICAgICB0aGlzLm9ubWVzc2FnZSh0aGlzLmV2ZW50KTsKICAgIH0KICB9Owp9Owp2YXIgUVdlYkNoYW5uZWwgPSBmdW5jdGlvbiAodHJhbnNwb3J0LCBpbml0Q2FsbGJhY2spIHsKICBpZiAodHlwZW9mIHRyYW5zcG9ydCAhPT0gJ29iamVjdCcgfHwgdHlwZW9mIHRyYW5zcG9ydC5zZW5kICE9PSAnZnVuY3Rpb24nKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGUgUVdlYkNoYW5uZWwgZXhwZWN0cyBhIHRyYW5zcG9ydCBvYmplY3Qgd2l0aCBhIHNlbmQgZnVuY3Rpb24gYW5kIG9ubWVzc2FnZSBjYWxsYmFjayBwcm9wZXJ0eS4nICsgJyBHaXZlbiBpczogdHJhbnNwb3J0OiAnICsgdHlwZW9mIHRyYW5zcG9ydCArICcsIHRyYW5zcG9ydC5zZW5kOiAnICsgdHlwZW9mIHRyYW5zcG9ydC5zZW5kKTsKICAgIHJldHVybjsKICB9CiAgdmFyIGNoYW5uZWwgPSB0aGlzOwogIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0OwogIHRoaXMuc2VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnKSB7CiAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKTsKICAgIH0KICAgIGNoYW5uZWwudHJhbnNwb3J0LnNlbmQoZGF0YSk7CiAgfTsKICB0aGlzLnRyYW5zcG9ydC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgdmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7CiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7CiAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpOwogICAgfQogICAgc3dpdGNoIChkYXRhLnR5cGUpIHsKICAgICAgY2FzZSBRV2ViQ2hhbm5lbE1lc3NhZ2VUeXBlcy5zaWduYWw6CiAgICAgICAgY2hhbm5lbC5oYW5kbGVTaWduYWwoZGF0YSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMucmVzcG9uc2U6CiAgICAgICAgY2hhbm5lbC5oYW5kbGVSZXNwb25zZShkYXRhKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBRV2ViQ2hhbm5lbE1lc3NhZ2VUeXBlcy5wcm9wZXJ0eVVwZGF0ZToKICAgICAgICBjaGFubmVsLmhhbmRsZVByb3BlcnR5VXBkYXRlKGRhdGEpOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ludmFsaWQgbWVzc2FnZSByZWNlaXZlZDonLCBtZXNzYWdlLmRhdGEpOwogICAgICAgIGJyZWFrOwogICAgfQogIH07CiAgdGhpcy5vYmplY3RzID0ge307CiAgdGhpcy5leGVjSWQgPSAwOwogIHRoaXMuZXhlY0NhbGxiYWNrcyA9IHt9OwogIHRoaXMucmVnaXN0ZXJDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgdmFyIGlkeCA9IC0xOwogICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgIGlmIChjaGFubmVsLmV4ZWNJZCA9PT0gTnVtYmVyLk1BWF9WQUxVRSkgewogICAgICAgIGNoYW5uZWwuZXhlY0lkID0gTnVtYmVyLk1JTl9WQUxVRTsKICAgICAgfQogICAgICBpZHggPSBjaGFubmVsLmV4ZWNJZCsrOwogICAgICBjaGFubmVsLmV4ZWNDYWxsYmFja3NbaWR4XSA9IGNhbGxiYWNrOwogICAgfQogICAgcmV0dXJuIGlkeDsKICB9OwogIHRoaXMuZXhlYyA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykgewogICAgaWYgKCFjYWxsYmFjaykgewogICAgICAvLyBpZiBubyBjYWxsYmFjayBpcyBnaXZlbiwgc2VuZCBkaXJlY3RseQogICAgICBjaGFubmVsLnNlbmQoZGF0YSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICgnaWQnIGluIGRhdGEpIHsKICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGV4ZWMgbWVzc2FnZSB3aXRoIHByb3BlcnR5IGlkOiAnICsgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICByZXR1cm47CiAgICB9CiAgICBkYXRhLmlkID0gY2hhbm5lbC5yZWdpc3RlckNhbGxiYWNrKGNhbGxiYWNrKTsKICAgIGNoYW5uZWwuZXhlY0NhbGxiYWNrc1tkYXRhLmlkXSA9IGNhbGxiYWNrOwogICAgY2hhbm5lbC5zZW5kKGRhdGEpOwogIH07CiAgdGhpcy5oYW5kbGVTaWduYWwgPSBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgdmFyIG9iamVjdCA9IGNoYW5uZWwub2JqZWN0c1ttZXNzYWdlLm9iamVjdF07CiAgICBpZiAob2JqZWN0KSB7CiAgICAgIG9iamVjdC5zaWduYWxFbWl0dGVkKG1lc3NhZ2Uuc2lnbmFsLCBtZXNzYWdlLmFyZ3MpOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS53YXJuKCdVbmhhbmRsZWQgc2lnbmFsOiAnICsgbWVzc2FnZS5vYmplY3QgKyAnOjonICsgbWVzc2FnZS5zaWduYWwpOwogICAgfQogIH07CiAgdGhpcy5oYW5kbGVSZXNwb25zZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7CiAgICAvLyBpZiAoIW1lc3NhZ2UuaGFzT3duUHJvcGVydHkoImlkIikpIHsKICAgIGlmICghKCdpZCcgaW4gbWVzc2FnZSkpIHsKICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXNwb25zZSBtZXNzYWdlIHJlY2VpdmVkOiAnLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNoYW5uZWwuZXhlY0NhbGxiYWNrc1ttZXNzYWdlLmlkXShtZXNzYWdlLmRhdGEpOwogICAgZGVsZXRlIGNoYW5uZWwuZXhlY0NhbGxiYWNrc1ttZXNzYWdlLmlkXTsKICB9OwogIHRoaXMuaGFuZGxlUHJvcGVydHlVcGRhdGUgPSBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgbWVzc2FnZS5kYXRhLmZvckVhY2goZGF0YSA9PiB7CiAgICAgIHZhciBvYmplY3QgPSBjaGFubmVsLm9iamVjdHNbZGF0YS5vYmplY3RdOwogICAgICBpZiAob2JqZWN0KSB7CiAgICAgICAgb2JqZWN0LnByb3BlcnR5VXBkYXRlKGRhdGEuc2lnbmFscywgZGF0YS5wcm9wZXJ0aWVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1VuaGFuZGxlZCBwcm9wZXJ0eSB1cGRhdGU6ICcgKyBkYXRhLm9iamVjdCArICc6OicgKyBkYXRhLnNpZ25hbCk7CiAgICAgIH0KICAgIH0pOwogICAgY2hhbm5lbC5leGVjKHsKICAgICAgdHlwZTogUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMuaWRsZQogICAgfSk7CiAgfTsKICB0aGlzLmhhbmRsZU1vZHVsZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBtb2R1bGUpIHsKICAgIHZhciBvYmplY3QgPSB0aGlzLm9iamVjdHNbbWVzc2FnZS5pZF07CiAgICBpZiAob2JqZWN0ID09PSB1bmRlZmluZWQpIHsKICAgICAgY29uc29sZS53YXJuKCdoYW5kbGVNb2R1bGU6IE9iamVjdE5hbWUgdW5kZWZpbmVkLicpOwogICAgICByZXR1cm47CiAgICB9CiAgICBmdW5jdGlvbiBhZGRNZXRob2QobWV0aG9kRGF0YSwgbW9kdWxlKSB7CiAgICAgIHZhciBtZXRob2ROYW1lID0gbWV0aG9kRGF0YVswXTsKICAgICAgdmFyIG1ldGhvZElkeCA9IG1ldGhvZERhdGFbMV07CiAgICAgIG1vZHVsZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgYXJncyA9IFtdOwogICAgICAgIHZhciBjYWxsYmFjayA9IHVuZGVmaW5lZDsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7CiAgICAgICAgICB2YXIgYXJndW1lbnQgPSBhcmd1bWVudHNbaV07CiAgICAgICAgICBpZiAodHlwZW9mIGFyZ3VtZW50ID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjayA9IGFyZ3VtZW50O2Vsc2UgYXJncy5wdXNoKGFyZ3VtZW50KTsKICAgICAgICB9CiAgICAgICAgdmFyIGlkeCA9IGNoYW5uZWwucmVnaXN0ZXJDYWxsYmFjayhjYWxsYmFjayk7CiAgICAgICAgY2hhbm5lbC5leGVjKHsKICAgICAgICAgIHR5cGU6IFFXZWJDaGFubmVsTWVzc2FnZVR5cGVzLmludm9rZUpTTWV0aG9kLAogICAgICAgICAgb2JqZWN0OiBvYmplY3QuX19pZF9fLAogICAgICAgICAgbmFtZTogbWV0aG9kTmFtZSwKICAgICAgICAgIG1ldGhvZDogbWV0aG9kSWR4LAogICAgICAgICAgYXJnczogYXJncywKICAgICAgICAgIGNhbGxiYWNrOiBpZHgKICAgICAgICB9KTsKICAgICAgfTsKICAgIH0KICAgIGZ1bmN0aW9uIGFkZE9iamVjdChkYXRhLCB0YXJnZXQpIHsKICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoZGF0YSkpIHsKICAgICAgICBpZiAoa2V5ID09PSAnX19tZXRob2RzX18nKSB7CiAgICAgICAgICBkYXRhLl9fbWV0aG9kc19fLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZERhdGEpIHsKICAgICAgICAgICAgYWRkTWV0aG9kKG1ldGhvZERhdGEsIHRhcmdldCk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IGMgPSB7fTsKICAgICAgICAgIHRhcmdldFtrZXldID0gYzsKICAgICAgICAgIGFkZE9iamVjdChkYXRhW2tleV0sIGMpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgYWRkT2JqZWN0KG1lc3NhZ2UubW9kdWxlLCBtb2R1bGUpOwogIH07CiAgdGhpcy5tb2R1bGVzID0ge307CiAgdGhpcy5pbXBvcnRNb2R1bGUgPSBmdW5jdGlvbiAodXJsLCBtb2R1bGVOYW1lLCBjYWxsYmFjaykgewogICAgdGhpcy5tb2R1bGVzW3VybF0gPSB7CiAgICAgIG1vZHVsZTogbW9kdWxlTmFtZSwKICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICB9OwogICAgbGV0IGNvcmUgPSB0aGlzLm9iamVjdHMuQ29yZTsKICAgIGNvcmUuaW1wb3J0TW9kdWxlKHVybCk7CiAgfTsKICB0aGlzLmRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgIGNoYW5uZWwuc2VuZCh7CiAgICAgIHR5cGU6IFFXZWJDaGFubmVsTWVzc2FnZVR5cGVzLmRlYnVnLAogICAgICBkYXRhOiBtZXNzYWdlCiAgICB9KTsKICB9OwogIGNoYW5uZWwuZXhlYyh7CiAgICB0eXBlOiBRV2ViQ2hhbm5lbE1lc3NhZ2VUeXBlcy5pbml0CiAgfSwgZnVuY3Rpb24gKGRhdGEpIHsKICAgIGZvciAoY29uc3Qgb2JqZWN0TmFtZSBvZiBPYmplY3Qua2V5cyhkYXRhKSkgewogICAgICBuZXcgUU9iamVjdChvYmplY3ROYW1lLCBkYXRhW29iamVjdE5hbWVdLCBjaGFubmVsKTsKICAgIH0KCiAgICAvLyBub3cgdW53cmFwIHByb3BlcnRpZXMsIHdoaWNoIG1pZ2h0IHJlZmVyZW5jZSBvdGhlciByZWdpc3RlcmVkIG9iamVjdHMKICAgIGZvciAoY29uc3Qgb2JqZWN0TmFtZSBvZiBPYmplY3Qua2V5cyhjaGFubmVsLm9iamVjdHMpKSB7CiAgICAgIGNoYW5uZWwub2JqZWN0c1tvYmplY3ROYW1lXS51bndyYXBQcm9wZXJ0aWVzKCk7CiAgICB9CiAgICBpZiAoaW5pdENhbGxiYWNrKSB7CiAgICAgIGluaXRDYWxsYmFjayhjaGFubmVsKTsKICAgIH0KICAgIGNoYW5uZWwuZXhlYyh7CiAgICAgIHR5cGU6IFFXZWJDaGFubmVsTWVzc2FnZVR5cGVzLmlkbGUKICAgIH0pOwogIH0pOwp9OwpmdW5jdGlvbiBRT2JqZWN0KG5hbWUsIGRhdGEsIHdlYkNoYW5uZWwpIHsKICB0aGlzLl9faWRfXyA9IG5hbWU7CiAgd2ViQ2hhbm5lbC5vYmplY3RzW25hbWVdID0gdGhpczsKCiAgLy8gTGlzdCBvZiBjYWxsYmFja3MgdGhhdCBnZXQgaW52b2tlZCB1cG9uIHNpZ25hbCBlbWlzc2lvbgogIHRoaXMuX19vYmplY3RTaWduYWxzX18gPSB7fTsKCiAgLy8gQ2FjaGUgb2YgYWxsIHByb3BlcnRpZXMsIHVwZGF0ZWQgd2hlbiBhIG5vdGlmeSBzaWduYWwgaXMgZW1pdHRlZAogIHRoaXMuX19wcm9wZXJ0eUNhY2hlX18gPSB7fTsKICB2YXIgb2JqZWN0ID0gdGhpczsKCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICB0aGlzLnVud3JhcFFPYmplY3QgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgIC8vIHN1cHBvcnQgbGlzdCBvZiBvYmplY3RzCiAgICAgIHJldHVybiByZXNwb25zZS5tYXAocW9iaiA9PiBvYmplY3QudW53cmFwUU9iamVjdChxb2JqKSk7CiAgICB9CiAgICBpZiAoIShyZXNwb25zZSBpbnN0YW5jZW9mIE9iamVjdCkpIHJldHVybiByZXNwb25zZTsKICAgIGlmICghcmVzcG9uc2VbJ19fUU9iamVjdCpfXyddIHx8IHJlc3BvbnNlLmlkID09PSB1bmRlZmluZWQpIHsKICAgICAgdmFyIGpPYmogPSB7fTsKICAgICAgZm9yIChjb25zdCBwcm9wTmFtZSBvZiBPYmplY3Qua2V5cyhyZXNwb25zZSkpIHsKICAgICAgICBqT2JqW3Byb3BOYW1lXSA9IG9iamVjdC51bndyYXBRT2JqZWN0KHJlc3BvbnNlW3Byb3BOYW1lXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGpPYmo7CiAgICB9CiAgICB2YXIgb2JqZWN0SWQgPSByZXNwb25zZS5pZDsKICAgIGlmICh3ZWJDaGFubmVsLm9iamVjdHNbb2JqZWN0SWRdKSByZXR1cm4gd2ViQ2hhbm5lbC5vYmplY3RzW29iamVjdElkXTsKICAgIGlmICghcmVzcG9uc2UuZGF0YSkgewogICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgdW53cmFwIHVua25vd24gUU9iamVjdCAnICsgb2JqZWN0SWQgKyAnIHdpdGhvdXQgZGF0YS4nKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdmFyIHFPYmplY3QgPSBuZXcgUU9iamVjdChvYmplY3RJZCwgcmVzcG9uc2UuZGF0YSwgd2ViQ2hhbm5lbCk7CiAgICBxT2JqZWN0LmRlc3Ryb3llZC5jb25uZWN0KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHdlYkNoYW5uZWwub2JqZWN0c1tvYmplY3RJZF0gPT09IHFPYmplY3QpIHsKICAgICAgICBkZWxldGUgd2ViQ2hhbm5lbC5vYmplY3RzW29iamVjdElkXTsKICAgICAgICAvLyByZXNldCB0aGUgbm93IGRlbGV0ZWQgUU9iamVjdCB0byBhbiBlbXB0eSB7fSBvYmplY3QKICAgICAgICAvLyBqdXN0IGFzc2lnbmluZyB7fSB0aG91Z2ggd291bGQgbm90IGhhdmUgdGhlIGRlc2lyZWQgZWZmZWN0LCBidXQgdGhlCiAgICAgICAgLy8gYmVsb3cgYWxzbyBlbnN1cmVzIGFsbCBleHRlcm5hbCByZWZlcmVuY2VzIHdpbGwgc2VlIHRoZSBlbXB0eSBtYXAKICAgICAgICAvLyBOT1RFOiB0aGlzIGRldG91ciBpcyBuZWNlc3NhcnkgdG8gd29ya2Fyb3VuZCBRVEJVRy00MDAyMQogICAgICAgIE9iamVjdC5rZXlzKHFPYmplY3QpLmZvckVhY2gobmFtZSA9PiBkZWxldGUgcU9iamVjdFtuYW1lXSk7CiAgICAgIH0KICAgIH0pOwogICAgLy8gaGVyZSB3ZSBhcmUgYWxyZWFkeSBpbml0aWFsaXplZCwgYW5kIHRodXMgbXVzdCBkaXJlY3RseSB1bndyYXAgdGhlIHByb3BlcnRpZXMKICAgIHFPYmplY3QudW53cmFwUHJvcGVydGllcygpOwogICAgcmV0dXJuIHFPYmplY3Q7CiAgfTsKICB0aGlzLnVud3JhcFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7CiAgICBmb3IgKGNvbnN0IHByb3BlcnR5SWR4IG9mIE9iamVjdC5rZXlzKG9iamVjdC5fX3Byb3BlcnR5Q2FjaGVfXykpIHsKICAgICAgb2JqZWN0Ll9fcHJvcGVydHlDYWNoZV9fW3Byb3BlcnR5SWR4XSA9IG9iamVjdC51bndyYXBRT2JqZWN0KG9iamVjdC5fX3Byb3BlcnR5Q2FjaGVfX1twcm9wZXJ0eUlkeF0pOwogICAgfQogIH07CiAgZnVuY3Rpb24gYWRkU2lnbmFsKHNpZ25hbERhdGEsIGlzUHJvcGVydHlOb3RpZnlTaWduYWwpIHsKICAgIHZhciBzaWduYWxOYW1lID0gc2lnbmFsRGF0YVswXTsKICAgIHZhciBzaWduYWxJbmRleCA9IHNpZ25hbERhdGFbMV07CiAgICBvYmplY3Rbc2lnbmFsTmFtZV0gPSB7CiAgICAgIGNvbm5lY3Q6IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0JhZCBjYWxsYmFjayBnaXZlbiB0byBjb25uZWN0IHRvIHNpZ25hbCAnICsgc2lnbmFsTmFtZSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIG9iamVjdC5fX29iamVjdFNpZ25hbHNfX1tzaWduYWxJbmRleF0gPSBvYmplY3QuX19vYmplY3RTaWduYWxzX19bc2lnbmFsSW5kZXhdIHx8IFtdOwogICAgICAgIG9iamVjdC5fX29iamVjdFNpZ25hbHNfX1tzaWduYWxJbmRleF0ucHVzaChjYWxsYmFjayk7CgogICAgICAgIC8vIG9ubHkgcmVxdWlyZWQgZm9yICJwdXJlIiBzaWduYWxzLCBoYW5kbGVkIHNlcGFyYXRlbHkgZm9yIHByb3BlcnRpZXMgaW4gcHJvcGVydHlVcGRhdGUKICAgICAgICBpZiAoaXNQcm9wZXJ0eU5vdGlmeVNpZ25hbCkgcmV0dXJuOwoKICAgICAgICAvLyBhbHNvIG5vdGUgdGhhdCB3ZSBhbHdheXMgZ2V0IG5vdGlmaWVkIGFib3V0IHRoZSBkZXN0cm95ZWQgc2lnbmFsCiAgICAgICAgaWYgKHNpZ25hbE5hbWUgPT09ICdkZXN0cm95ZWQnIHx8IHNpZ25hbE5hbWUgPT09ICdkZXN0cm95ZWQoKScgfHwgc2lnbmFsTmFtZSA9PT0gJ2Rlc3Ryb3llZChRT2JqZWN0KiknKSByZXR1cm47CgogICAgICAgIC8vIGFuZCBvdGhlcndpc2Ugd2Ugb25seSBuZWVkIHRvIGJlIGNvbm5lY3RlZCBvbmx5IG9uY2UKICAgICAgICBpZiAob2JqZWN0Ll9fb2JqZWN0U2lnbmFsc19fW3NpZ25hbEluZGV4XS5sZW5ndGggPT0gMSkgewogICAgICAgICAgd2ViQ2hhbm5lbC5leGVjKHsKICAgICAgICAgICAgdHlwZTogUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMuY29ubmVjdFRvU2lnbmFsLAogICAgICAgICAgICBvYmplY3Q6IG9iamVjdC5fX2lkX18sCiAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsSW5kZXgKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlzY29ubmVjdDogZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgY29uc29sZS5lcnJvcignQmFkIGNhbGxiYWNrIGdpdmVuIHRvIGRpc2Nvbm5lY3QgZnJvbSBzaWduYWwgJyArIHNpZ25hbE5hbWUpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyBUaGlzIG1ha2VzIGEgbmV3IGxpc3QuIFRoaXMgaXMgaW1wb3J0YW50IGJlY2F1c2UgaXQgd29uJ3QgaW50ZXJmZXJlIHdpdGgKICAgICAgICAvLyBzaWduYWwgcHJvY2Vzc2luZyBpZiBhIGRpc2Nvbm5lY3Rpb24gaGFwcGVucyB3aGlsZSBlbWl0dGlnIGEgc2lnbmFsCiAgICAgICAgb2JqZWN0Ll9fb2JqZWN0U2lnbmFsc19fW3NpZ25hbEluZGV4XSA9IChvYmplY3QuX19vYmplY3RTaWduYWxzX19bc2lnbmFsSW5kZXhdIHx8IFtdKS5maWx0ZXIoZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiBjICE9IGNhbGxiYWNrOwogICAgICAgIH0pOwogICAgICAgIGlmICghaXNQcm9wZXJ0eU5vdGlmeVNpZ25hbCAmJiBvYmplY3QuX19vYmplY3RTaWduYWxzX19bc2lnbmFsSW5kZXhdLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgLy8gb25seSByZXF1aXJlZCBmb3IgInB1cmUiIHNpZ25hbHMsIGhhbmRsZWQgc2VwYXJhdGVseSBmb3IgcHJvcGVydGllcyBpbiBwcm9wZXJ0eVVwZGF0ZQogICAgICAgICAgd2ViQ2hhbm5lbC5leGVjKHsKICAgICAgICAgICAgdHlwZTogUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMuZGlzY29ubmVjdEZyb21TaWduYWwsCiAgICAgICAgICAgIG9iamVjdDogb2JqZWN0Ll9faWRfXywKICAgICAgICAgICAgc2lnbmFsOiBzaWduYWxJbmRleAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0aGVuOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICB0aGlzLmNvbm5lY3QoY2FsbGJhY2spOwogICAgICB9CiAgICB9OwogIH0KCiAgLyoqDQogICAqIEludm9rZXMgYWxsIGNhbGxiYWNrcyBmb3IgdGhlIGdpdmVuIHNpZ25hbG5hbWUuIEFsc28gd29ya3MgZm9yIHByb3BlcnR5IG5vdGlmeSBjYWxsYmFja3MuDQogICAqLwogIGZ1bmN0aW9uIGludm9rZVNpZ25hbENhbGxiYWNrcyhzaWduYWxOYW1lLCBzaWduYWxBcmdzKSB7CiAgICB2YXIgY29ubmVjdGlvbnMgPSBvYmplY3QuX19vYmplY3RTaWduYWxzX19bc2lnbmFsTmFtZV07CiAgICBpZiAoY29ubmVjdGlvbnMpIHsKICAgICAgY29ubmVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICBjYWxsYmFjay5hcHBseShjYWxsYmFjaywgc2lnbmFsQXJncyk7CiAgICAgIH0pOwogICAgfQogIH0KICB0aGlzLnByb3BlcnR5VXBkYXRlID0gZnVuY3Rpb24gKHNpZ25hbHMsIHByb3BlcnR5TWFwKSB7CiAgICAvLyB1cGRhdGUgcHJvcGVydHkgY2FjaGUKICAgIGZvciAoY29uc3QgcHJvcGVydHlJbmRleCBvZiBPYmplY3Qua2V5cyhwcm9wZXJ0eU1hcCkpIHsKICAgICAgdmFyIHByb3BlcnR5VmFsdWUgPSBwcm9wZXJ0eU1hcFtwcm9wZXJ0eUluZGV4XTsKICAgICAgb2JqZWN0Ll9fcHJvcGVydHlDYWNoZV9fW3Byb3BlcnR5SW5kZXhdID0gdGhpcy51bndyYXBRT2JqZWN0KHByb3BlcnR5VmFsdWUpOwogICAgfQogICAgZm9yIChjb25zdCBzaWduYWxOYW1lIG9mIE9iamVjdC5rZXlzKHNpZ25hbHMpKSB7CiAgICAgIC8vIEludm9rZSBhbGwgY2FsbGJhY2tzLCBhcyBzaWduYWxFbWl0dGVkKCkgZG9lcyBub3QuIFRoaXMgZW5zdXJlcyB0aGUKICAgICAgLy8gcHJvcGVydHkgY2FjaGUgaXMgdXBkYXRlZCBiZWZvcmUgdGhlIGNhbGxiYWNrcyBhcmUgaW52b2tlZC4KICAgICAgaW52b2tlU2lnbmFsQ2FsbGJhY2tzKHNpZ25hbE5hbWUsIHNpZ25hbHNbc2lnbmFsTmFtZV0pOwogICAgfQogIH07CiAgdGhpcy5zaWduYWxFbWl0dGVkID0gZnVuY3Rpb24gKHNpZ25hbE5hbWUsIHNpZ25hbEFyZ3MpIHsKICAgIGludm9rZVNpZ25hbENhbGxiYWNrcyhzaWduYWxOYW1lLCB0aGlzLnVud3JhcFFPYmplY3Qoc2lnbmFsQXJncykpOwogIH07CiAgZnVuY3Rpb24gYWRkTWV0aG9kKG1ldGhvZERhdGEpIHsKICAgIHZhciBtZXRob2ROYW1lID0gbWV0aG9kRGF0YVswXTsKICAgIHZhciBtZXRob2RJZHggPSBtZXRob2REYXRhWzFdOwoKICAgIC8vIEZ1bGx5IHNwZWNpZmllZCBtZXRob2RzIGFyZSBpbnZva2VkIGJ5IGlkLCBvdGhlcnMgYnkgbmFtZSBmb3IgaG9zdC1zaWRlIG92ZXJsb2FkIHJlc29sdXRpb24KICAgIHZhciBpbnZva2VkTWV0aG9kID0gbWV0aG9kTmFtZVttZXRob2ROYW1lLmxlbmd0aCAtIDFdID09PSAnKScgPyBtZXRob2RJZHggOiBtZXRob2ROYW1lOwogICAgb2JqZWN0W21ldGhvZE5hbWVdID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgYXJncyA9IFtdOwogICAgICB2YXIgY2FsbGJhY2sgPSB1bmRlZmluZWQ7CiAgICAgIHZhciBlcnJDYWxsYmFjazsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHsKICAgICAgICB2YXIgYXJndW1lbnQgPSBhcmd1bWVudHNbaV07CiAgICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudCA9PT0gJ2Z1bmN0aW9uJykgY2FsbGJhY2sgPSBhcmd1bWVudDtlbHNlIGFyZ3MucHVzaChhcmd1bWVudCk7CiAgICAgIH0KICAgICAgdmFyIGhhc0NhbGxiYWNrID0gY2FsbGJhY2sgIT09IHVuZGVmaW5lZDsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgLy8gZHVyaW5nIHRlc3QsIHdlYkNoYW5uZWwuZXhlYyBzeW5jaHJvbm91c2x5IGNhbGxzIHRoZSBjYWxsYmFjawogICAgICAvLyB0aGVyZWZvcmUsIHRoZSBwcm9taXNlIG11c3QgYmUgY29uc3R1Y3RlZCBiZWZvcmUgY2FsbGluZwogICAgICAvLyB3ZWJDaGFubmVsLmV4ZWMgdG8gZW5zdXJlIHRoZSBjYWxsYmFjayBpcyBzZXQgdXAKICAgICAgaWYgKCFjYWxsYmFjayAmJiB0eXBlb2YgUHJvbWlzZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJlc3VsdCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgIGNhbGxiYWNrID0gcmVzb2x2ZTsKICAgICAgICAgIGVyckNhbGxiYWNrID0gcmVqZWN0OwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHdlYkNoYW5uZWwuZXhlYyh7CiAgICAgICAgdHlwZTogUVdlYkNoYW5uZWxNZXNzYWdlVHlwZXMuaW52b2tlTWV0aG9kLAogICAgICAgIG9iamVjdDogb2JqZWN0Ll9faWRfXywKICAgICAgICBtZXRob2Q6IGludm9rZWRNZXRob2QsCiAgICAgICAgYXJnczogYXJncywKICAgICAgICBjYWxsYmFjazogaGFzQ2FsbGJhY2sKICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSBvYmplY3QudW53cmFwUU9iamVjdChyZXNwb25zZSk7CiAgICAgICAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgICAgICAgY2FsbGJhY2socmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGVyckNhbGxiYWNrKSB7CiAgICAgICAgICBlcnJDYWxsYmFjaygpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogIH0KICBmdW5jdGlvbiBiaW5kR2V0dGVyU2V0dGVyKHByb3BlcnR5SW5mbykgewogICAgdmFyIHByb3BlcnR5SW5kZXggPSBwcm9wZXJ0eUluZm9bMF07CiAgICB2YXIgcHJvcGVydHlOYW1lID0gcHJvcGVydHlJbmZvWzFdOwogICAgdmFyIG5vdGlmeVNpZ25hbERhdGEgPSBwcm9wZXJ0eUluZm9bMl07CiAgICAvLyBpbml0aWFsaXplIHByb3BlcnR5IGNhY2hlIHdpdGggY3VycmVudCB2YWx1ZQogICAgLy8gTk9URTogaWYgdGhpcyBpcyBhbiBvYmplY3QsIGl0IGlzIG5vdCBkaXJlY3RseSB1bndyYXBwZWQgYXMgaXQgbWlnaHQKICAgIC8vIHJlZmVyZW5jZSBvdGhlciBRT2JqZWN0IHRoYXQgd2UgZG8gbm90IGtub3cgeWV0CiAgICBvYmplY3QuX19wcm9wZXJ0eUNhY2hlX19bcHJvcGVydHlJbmRleF0gPSBwcm9wZXJ0eUluZm9bM107CiAgICBpZiAobm90aWZ5U2lnbmFsRGF0YSkgewogICAgICBpZiAobm90aWZ5U2lnbmFsRGF0YVswXSA9PT0gMSkgewogICAgICAgIC8vIHNpZ25hbCBuYW1lIGlzIG9wdGltaXplZCBhd2F5LCByZWNvbnN0cnVjdCB0aGUgYWN0dWFsIG5hbWUKICAgICAgICBub3RpZnlTaWduYWxEYXRhWzBdID0gcHJvcGVydHlOYW1lICsgJ0NoYW5nZWQnOwogICAgICB9CiAgICAgIGFkZFNpZ25hbChub3RpZnlTaWduYWxEYXRhLCB0cnVlKTsKICAgIH0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5TmFtZSwgewogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBwcm9wZXJ0eVZhbHVlID0gb2JqZWN0Ll9fcHJvcGVydHlDYWNoZV9fW3Byb3BlcnR5SW5kZXhdOwogICAgICAgIGlmIChwcm9wZXJ0eVZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIC8vIFRoaXMgc2hvdWxkbid0IGhhcHBlbgogICAgICAgICAgY29uc29sZS53YXJuKCdVbmRlZmluZWQgdmFsdWUgaW4gcHJvcGVydHkgY2FjaGUgZm9yIHByb3BlcnR5ICInICsgcHJvcGVydHlOYW1lICsgJyIgaW4gb2JqZWN0ICcgKyBvYmplY3QuX19pZF9fKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHByb3BlcnR5VmFsdWU7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvbnNvbGUud2FybignUHJvcGVydHkgc2V0dGVyIGZvciAnICsgcHJvcGVydHlOYW1lICsgJyBjYWxsZWQgd2l0aCB1bmRlZmluZWQgdmFsdWUhJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIG9iamVjdC5fX3Byb3BlcnR5Q2FjaGVfX1twcm9wZXJ0eUluZGV4XSA9IHZhbHVlOwogICAgICAgIHZhciB2YWx1ZVRvU2VuZCA9IHZhbHVlOwogICAgICAgIHdlYkNoYW5uZWwuZXhlYyh7CiAgICAgICAgICB0eXBlOiBRV2ViQ2hhbm5lbE1lc3NhZ2VUeXBlcy5zZXRQcm9wZXJ0eSwKICAgICAgICAgIG9iamVjdDogb2JqZWN0Ll9faWRfXywKICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eUluZGV4LAogICAgICAgICAgdmFsdWU6IHZhbHVlVG9TZW5kCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICBkYXRhLm1ldGhvZHMuZm9yRWFjaChhZGRNZXRob2QpOwogIGRhdGEucHJvcGVydGllcy5mb3JFYWNoKGJpbmRHZXR0ZXJTZXR0ZXIpOwogIGRhdGEuc2lnbmFscy5mb3JFYWNoKGZ1bmN0aW9uIChzaWduYWwpIHsKICAgIGFkZFNpZ25hbChzaWduYWwsIGZhbHNlKTsKICB9KTsKICBPYmplY3QuYXNzaWduKG9iamVjdCwgZGF0YS5lbnVtcyk7Cn0KUU9iamVjdC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkgewogIGlmICh0aGlzLl9faWRfXyA9PT0gdW5kZWZpbmVkKSByZXR1cm4ge307CiAgcmV0dXJuIHsKICAgIGlkOiB0aGlzLl9faWRfXywKICAgICdfX1FPYmplY3QqX18nOiB0cnVlCiAgfTsKfTsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gU1NXZWJDaGFubmVsKGVsZW1lbnQsIGNhbGxiYWNrKSB7CiAgdmFyIG1vdXNlRG93biA9IGZhbHNlOwogIHZhciBtb3VzZVBvc2l0aW9uID0gewogICAgeDogMCwKICAgIHk6IDAKICB9OwogIHZhciBjb3JlOwogIGZ1bmN0aW9uIGdldFBvc2l0aW9uKGVsZW1lbnQsIGV2ZW50LCByZXN1bHQpIHsKICAgIGlmIChlbGVtZW50ID09PSBkb2N1bWVudCkgewogICAgICByZXN1bHQueCA9IGV2ZW50LmNsaWVudFg7CiAgICAgIHJlc3VsdC55ID0gZXZlbnQuY2xpZW50WTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHJlc3VsdC54ID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdDsKICAgIHJlc3VsdC55ID0gZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CiAgZnVuY3Rpb24gcmVnaXN0ZXJMaXN0ZW5lcihkb21UeXBlLCBlbGVtZW50LCBjYWxsYmFjaykgewogICAgZnVuY3Rpb24gbGlzdGVuZXIoZSkgewogICAgICAvLyBjb25zb2xlLmxvZyhkb21UeXBlKTsKICAgICAgY2FsbGJhY2soZWxlbWVudCwgZSk7CiAgICB9CiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZG9tVHlwZSwgbGlzdGVuZXIsIHsKICAgICAgY2FwdHVyZTogZmFsc2UsCiAgICAgIHBhc3NpdmU6IHRydWUKICAgIH0pOwogICAgY29uc29sZS5sb2coJ3JlZ2lzdGVyTGlzdGVuZXIgJyArIGRvbVR5cGUpOwogIH0KICBmdW5jdGlvbiBnZXRDaGFuZ2VkVG91Y2hlcyhlbGVtZW50LCBldmVudCkgewogICAgdmFyIGxpc3QgPSBbXTsKICAgIHZhciBjaGFuZ2VkVG91Y2hlcyA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzOwogICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSA8IGxlbiAmJiBpIDwgMjsgKytpKSB7CiAgICAgIGxldCB0b3VjaCA9IGNoYW5nZWRUb3VjaGVzW2ldOwogICAgICBsZXQgcG9zaXRpb24gPSBnZXRQb3NpdGlvbihlbGVtZW50LCB0b3VjaCwgbW91c2VQb3NpdGlvbik7CiAgICAgIGxpc3QucHVzaCh7CiAgICAgICAgaWQ6IHRvdWNoLmlkZW50aWZpZXIsCiAgICAgICAgeDogcG9zaXRpb24ueCwKICAgICAgICB5OiBwb3NpdGlvbi55CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIGxpc3Q7CiAgfQogIGZ1bmN0aW9uIGhhbmRsZVRvdWNoU3RhcnQoZWxlbWVudCwgZXZlbnQpIHsKICAgIG1vdXNlRG93biA9IHRydWU7CiAgICBsZXQgbGlzdCA9IGdldENoYW5nZWRUb3VjaGVzKGVsZW1lbnQsIGV2ZW50KTsKICAgIGNvcmUudG91Y2hTdGFydChsaXN0KTsKICB9CiAgdmFyIGxhc3RNb3ZlID0gMDsKICB2YXIgbGFzdEhvdXIgPSAtMTsKICBmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmUoZWxlbWVudCwgZXZlbnQpIHsKICAgIGlmIChtb3VzZURvd24pIHsKICAgICAgbGV0IHQgPSBuZXcgRGF0ZSgpOwogICAgICBsZXQgaG91ciA9IHQuZ2V0SG91cnMoKTsKICAgICAgaWYgKGxhc3RIb3VyID4gaG91cikgewogICAgICAgIGxhc3RNb3ZlID0gMDsKICAgICAgfQogICAgICBsZXQgY3VycmVudCA9IGhvdXIgKiAoNjAgKiA2MCkgKyB0LmdldE1pbnV0ZXMoKSAqIDYwICsgdC5nZXRTZWNvbmRzKCkgKyB0LmdldE1pbGxpc2Vjb25kcygpICogMWUtMzsKICAgICAgaWYgKGN1cnJlbnQgLSBsYXN0TW92ZSA+IDEuMCAvIDIwLjApIHsKICAgICAgICBsYXN0TW92ZSA9IGN1cnJlbnQ7CiAgICAgICAgbGFzdEhvdXIgPSBob3VyOwogICAgICAgIGxldCBsaXN0ID0gZ2V0Q2hhbmdlZFRvdWNoZXMoZWxlbWVudCwgZXZlbnQpOwogICAgICAgIGNvcmUudG91Y2hNb3ZlKGxpc3QpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGhhbmRsZVRvdWNoRW5kKGVsZW1lbnQsIGV2ZW50KSB7CiAgICBpZiAobW91c2VEb3duKSB7CiAgICAgIGxldCBsaXN0ID0gZ2V0Q2hhbmdlZFRvdWNoZXMoZWxlbWVudCwgZXZlbnQpOwogICAgICBjb3JlLnRvdWNoRW5kKGxpc3QpOwogICAgfQogICAgbW91c2VEb3duID0gZmFsc2U7CiAgfQogIHZhciBzb2NrZXQgPSBuZXcgV2ViQ2hhbm5lbFNvY2tldCgpOwogIHdpbmRvdy53ZWJDaGFubmVsU29ja2V0ID0gc29ja2V0OwogIHNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24gKCkgewogICAgY29uc29sZS5lcnJvcignd2ViIGNoYW5uZWwgY2xvc2VkJyk7CiAgfTsKICBzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignd2ViIGNoYW5uZWwgZXJyb3I6ICcgKyBlcnJvcik7CiAgfTsKICBzb2NrZXQub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgY29uc29sZS5sb2coJ3NvY2tldCBpcyBvcGVubmluZycpOwogICAgbmV3IFFXZWJDaGFubmVsKHNvY2tldCwgZnVuY3Rpb24gKGNoYW5uZWwpIHsKICAgICAgLy8gbWFrZSBjb3JlIG9iamVjdCBhY2Nlc3NpYmxlIGdsb2JhbGx5CiAgICAgIGNvcmUgPSBjaGFubmVsLm9iamVjdHMuQ29yZTsKICAgICAgdmFyIHZpZXdlciA9IHt9OwogICAgICB2aWV3ZXIubGlzdGVuZXJzID0ge307CiAgICAgIHZpZXdlci5saXN0ZW5lcnNbJ3VwZGF0ZSddID0gW107CiAgICAgIHdpbmRvdy5HbG9iYWxWaWV3ZXIgPSB2aWV3ZXI7CiAgICAgIHZpZXdlci5hZGRFdmVudExpc3RlbmVyID0gKHR5cGUsIGNhbGxiYWNrKSA9PiB7CiAgICAgICAgaWYgKHR5cGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgICB2aWV3ZXIubGlzdGVuZXJzWyd1cGRhdGUnXS5wdXNoKGNhbGxiYWNrKTsKICAgICAgICAgIGNvcmUuZnJhbWVVcGRhdGUuY29ubmVjdChjYWxsYmFjayk7CiAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgfQogICAgICB9OwogICAgICB2aWV3ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGxpc3RlbmVyID0+IHsKICAgICAgICBsZXQgbGlzdGVuZXJzID0gdmlld2VyLmxpc3RlbmVyc1sndXBkYXRlJ107CiAgICAgICAgbGV0IGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpOwogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICAgIGNvcmUuZnJhbWVVcGRhdGUuZGlzY29ubmVjdChsaXN0ZW5lcik7CiAgICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHZpZXdlci5vbk5hdGl2ZU5vdGlmeSA9IGNhbGxiYWNrID0+IHsKICAgICAgICBjb3JlLm5hdGl2ZU5vdGlmeS5jb25uZWN0KGRhdGEgPT4gewogICAgICAgICAgY2FsbGJhY2soZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIGNvcmUub3V0cHV0TWVzc2FnZS5jb25uZWN0KG1zZyA9PiB7CiAgICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgfSk7CiAgICAgIGNvcmUubW9kdWxlTG9hZGVkLmNvbm5lY3QoKHVybCwgZGF0YSkgPT4gewogICAgICAgIGxldCBtb2R1bGVEYXRhID0gY2hhbm5lbC5tb2R1bGVzW3VybF07CiAgICAgICAgbGV0IG1vZHVsZU5hbWUgPSBtb2R1bGVEYXRhLm1vZHVsZTsKICAgICAgICBsZXQgY2FsbGJhY2sgPSBtb2R1bGVEYXRhLmNhbGxiYWNrOwogICAgICAgIGxldCBtb2R1bGU7CiAgICAgICAgaWYgKCFtb2R1bGVOYW1lIHx8IG1vZHVsZU5hbWUgPT09ICcnKSB7CiAgICAgICAgICBtb2R1bGUgPSB3aW5kb3c7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh3aW5kb3dbbW9kdWxlTmFtZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICB3aW5kb3dbbW9kdWxlTmFtZV0gPSB7fTsKICAgICAgICAgIH0KICAgICAgICAgIG1vZHVsZSA9IHdpbmRvd1ttb2R1bGVOYW1lXTsKICAgICAgICB9CiAgICAgICAgY2hhbm5lbC5oYW5kbGVNb2R1bGUoZGF0YSwgbW9kdWxlKTsKICAgICAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCdtb2R1bGUgbG9hZGVkOiAnICsgdXJsKTsKICAgICAgfSk7CiAgICAgIGNvcmUubmF0aXZlQ2FsbGJhY2suY29ubmVjdChtZXNzYWdlID0+IHsKICAgICAgICBsZXQgY2FsbGJhY2sgPSBjaGFubmVsLmV4ZWNDYWxsYmFja3NbbWVzc2FnZS5jYWxsYmFja107CiAgICAgICAgaWYgKCFjYWxsYmFjaykgewogICAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXNwb25zZSBtZXNzYWdlIHJlY2VpdmVkOiAnLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNhbGxiYWNrKG1lc3NhZ2UuZGF0YSk7CiAgICAgICAgLy8gZGVsZXRlIGNoYW5uZWwuZXhlY0NhbGxiYWNrc1ttZXNzYWdlLmNhbGxiYWNrXTsKICAgICAgfSk7CiAgICAgIGVsZW1lbnQub25tb3VzZW92ZXIgPSAoKSA9PiB7CiAgICAgICAgY29yZS5tb3VzZU92ZXJDYW52YXMoKTsKICAgICAgfTsKICAgICAgZWxlbWVudC5vbm1vdXNlb3V0ID0gKCkgPT4gewogICAgICAgIGNvcmUubW91c2VPdXRDYW52YXMoKTsKICAgICAgfTsKICAgICAgZWxlbWVudC5vbmZvY3VzID0gKCkgPT4gewogICAgICAgIGNvcmUub25Gb2N1cygpOwogICAgICB9OwogICAgICBlbGVtZW50Lm9uYmx1ciA9ICgpID0+IHsKICAgICAgICBjb3JlLm9uQmx1cigpOwogICAgICB9OwogICAgICByZWdpc3Rlckxpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZWxlbWVudCwgaGFuZGxlVG91Y2hTdGFydCk7CiAgICAgIHJlZ2lzdGVyTGlzdGVuZXIoJ3RvdWNobW92ZScsIGVsZW1lbnQsIGhhbmRsZVRvdWNoTW92ZSk7CiAgICAgIHJlZ2lzdGVyTGlzdGVuZXIoJ3RvdWNoZW5kJywgZWxlbWVudCwgaGFuZGxlVG91Y2hFbmQpOwogICAgICByZWdpc3Rlckxpc3RlbmVyKCd0b3VjaGNhbmNlbCcsIGVsZW1lbnQsIGhhbmRsZVRvdWNoRW5kKTsKICAgICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soY2hhbm5lbCk7CiAgICAgIH0KICAgIH0pOwogIH07CiAgc29ja2V0Lm9ub3BlbigpOwp9"},{"version":3,"names":["QWebChannelMessageTypes","signal","propertyUpdate","init","idle","debug","invokeMethod","connectToSignal","disconnectFromSignal","setProperty","response","invokeJSMethod","MessageQueue","maxCount","queue","length","currentSetIdx","currentGetIdx","count","enqueue","data","dequeue","undefined","dequeueAll","result","i","WebChannelSocket","getMessage","getCurrentGetIdx","send","message","event","receive","onmessage","QWebChannel","transport","initCallback","console","error","channel","JSON","stringify","parse","type","handleSignal","handleResponse","handlePropertyUpdate","objects","execId","execCallbacks","registerCallback","callback","idx","Number","MAX_VALUE","MIN_VALUE","exec","id","object","signalEmitted","args","warn","forEach","signals","properties","handleModule","module","addMethod","methodData","methodName","methodIdx","len","arguments","argument","push","__id__","name","method","addObject","target","key","Object","keys","__methods__","c","modules","importModule","url","moduleName","core","Core","objectName","QObject","unwrapProperties","webChannel","__objectSignals__","__propertyCache__","unwrapQObject","Array","map","qobj","jObj","propName","objectId","qObject","destroyed","connect","propertyIdx","addSignal","signalData","isPropertyNotifySignal","signalName","signalIndex","disconnect","filter","then","invokeSignalCallbacks","signalArgs","connections","apply","propertyMap","propertyIndex","propertyValue","invokedMethod","errCallback","hasCallback","Promise","resolve","reject","bindGetterSetter","propertyInfo","propertyName","notifySignalData","defineProperty","configurable","get","set","value","valueToSend","property","methods","assign","enums","prototype","toJSON","SSWebChannel","element","mouseDown","mousePosition","x","y","getPosition","document","clientX","clientY","rect","getBoundingClientRect","left","top","registerListener","domType","listener","e","addEventListener","capture","passive","log","getChangedTouches","list","changedTouches","touch","position","identifier","handleTouchStart","touchStart","lastMove","lastHour","handleTouchMove","t","Date","hour","getHours","current","getMinutes","getSeconds","getMilliseconds","touchMove","handleTouchEnd","touchEnd","socket","window","webChannelSocket","onclose","onerror","onopen","viewer","listeners","GlobalViewer","frameUpdate","removeEventListener","index","indexOf","splice","onNativeNotify","nativeNotify","outputMessage","msg","moduleLoaded","moduleData","nativeCallback","onmouseover","mouseOverCanvas","onmouseout","mouseOutCanvas","onfocus","onFocus","onblur","onBlur"],"sources":["C:/Users/sun.ruiqi/LAE_dashboard/code/public/SSWebChannel.js"],"sourcesContent":["'use strict'\r\n\r\nvar QWebChannelMessageTypes = {\r\n\tsignal: 1,\r\n\tpropertyUpdate: 2,\r\n\tinit: 3,\r\n\tidle: 4,\r\n\tdebug: 5,\r\n\tinvokeMethod: 6,\r\n\tconnectToSignal: 7,\r\n\tdisconnectFromSignal: 8,\r\n\tsetProperty: 9,\r\n\tresponse: 10,\r\n\tinvokeJSMethod: 11,\r\n}\r\n\r\nvar MessageQueue = function () {\r\n\tthis.maxCount = 2048\r\n\tthis.queue = []\r\n\tthis.queue.length = this.maxCount\r\n\tthis.currentSetIdx = 0\r\n\tthis.currentGetIdx = 0\r\n\tthis.count = 0\r\n\r\n\tthis.enqueue = (data) => {\r\n\t\tthis.queue[this.currentSetIdx] = data\r\n\r\n\t\t++this.count\r\n\r\n\t\tthis.currentSetIdx = (this.currentSetIdx + 1) % this.maxCount\r\n\t}\r\n\r\n\tthis.dequeue = () => {\r\n\t\tif (this.count <= 0) {\r\n\t\t\treturn undefined\r\n\t\t}\r\n\r\n\t\tlet data = this.queue[this.currentGetIdx]\r\n\r\n\t\t--this.count\r\n\r\n\t\tthis.currentGetIdx = (this.currentGetIdx + 1) % this.maxCount\r\n\r\n\t\treturn data\r\n\t}\r\n\r\n\tthis.dequeueAll = () => {\r\n\t\tif (this.count) {\r\n\t\t\tlet result = '['\r\n\t\t\tfor (let i = 0; i < this.count; i++) {\r\n\t\t\t\tif (i > 0) result += ','\r\n\t\t\t\tresult += this.dequeue()\r\n\t\t\t}\r\n\t\t\tresult += ']'\r\n\t\t\treturn result\r\n\t\t} else return ''\r\n\t}\r\n}\r\n\r\nvar WebChannelSocket = function () {\r\n\tthis.queue = new MessageQueue()\r\n\r\n\tthis.getMessage = () => {\r\n\t\treturn this.queue.dequeueAll()\r\n\t}\r\n\r\n\tthis.getCurrentGetIdx = () => {\r\n\t\treturn this.queue.currentGetIdx\r\n\t}\r\n\r\n\tthis.send = (message) => {\r\n\t\tthis.queue.enqueue(message)\r\n\t}\r\n\r\n\tthis.event = {\r\n\t\tdata: undefined,\r\n\t}\r\n\r\n\tthis.receive = (message) => {\r\n\t\tif (this.onmessage) {\r\n\t\t\tthis.event.data = message\r\n\t\t\tthis.onmessage(this.event)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar QWebChannel = function (transport, initCallback) {\r\n\tif (typeof transport !== 'object' || typeof transport.send !== 'function') {\r\n\t\tconsole.error(\r\n\t\t\t'The QWebChannel expects a transport object with a send function and onmessage callback property.' +\r\n\t\t\t\t' Given is: transport: ' +\r\n\t\t\t\ttypeof transport +\r\n\t\t\t\t', transport.send: ' +\r\n\t\t\t\ttypeof transport.send\r\n\t\t)\r\n\t\treturn\r\n\t}\r\n\r\n\tvar channel = this\r\n\tthis.transport = transport\r\n\r\n\tthis.send = function (data) {\r\n\t\tif (typeof data !== 'string') {\r\n\t\t\tdata = JSON.stringify(data)\r\n\t\t}\r\n\t\tchannel.transport.send(data)\r\n\t}\r\n\r\n\tthis.transport.onmessage = function (message) {\r\n\t\tvar data = message.data\r\n\t\tif (typeof data === 'string') {\r\n\t\t\tdata = JSON.parse(data)\r\n\t\t}\r\n\t\tswitch (data.type) {\r\n\t\t\tcase QWebChannelMessageTypes.signal:\r\n\t\t\t\tchannel.handleSignal(data)\r\n\t\t\t\tbreak\r\n\t\t\tcase QWebChannelMessageTypes.response:\r\n\t\t\t\tchannel.handleResponse(data)\r\n\t\t\t\tbreak\r\n\t\t\tcase QWebChannelMessageTypes.propertyUpdate:\r\n\t\t\t\tchannel.handlePropertyUpdate(data)\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.error('invalid message received:', message.data)\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\tthis.objects = {}\r\n\r\n\tthis.execId = 0\r\n\tthis.execCallbacks = {}\r\n\r\n\tthis.registerCallback = function (callback) {\r\n\t\tvar idx = -1\r\n\t\tif (callback) {\r\n\t\t\tif (channel.execId === Number.MAX_VALUE) {\r\n\t\t\t\tchannel.execId = Number.MIN_VALUE\r\n\t\t\t}\r\n\t\t\tidx = channel.execId++\r\n\t\t\tchannel.execCallbacks[idx] = callback\r\n\t\t}\r\n\t\treturn idx\r\n\t}\r\n\r\n\tthis.exec = function (data, callback) {\r\n\t\tif (!callback) {\r\n\t\t\t// if no callback is given, send directly\r\n\t\t\tchannel.send(data)\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif ('id' in data) {\r\n\t\t\tconsole.error('Cannot exec message with property id: ' + JSON.stringify(data))\r\n\t\t\treturn\r\n\t\t}\r\n\t\tdata.id = channel.registerCallback(callback)\r\n\t\tchannel.execCallbacks[data.id] = callback\r\n\t\tchannel.send(data)\r\n\t}\r\n\r\n\tthis.handleSignal = function (message) {\r\n\t\tvar object = channel.objects[message.object]\r\n\t\tif (object) {\r\n\t\t\tobject.signalEmitted(message.signal, message.args)\r\n\t\t} else {\r\n\t\t\tconsole.warn('Unhandled signal: ' + message.object + '::' + message.signal)\r\n\t\t}\r\n\t}\r\n\r\n\tthis.handleResponse = function (message) {\r\n\t\t// if (!message.hasOwnProperty(\"id\")) {\r\n\t\tif (!('id' in message)) {\r\n\t\t\tconsole.error('Invalid response message received: ', JSON.stringify(message))\r\n\t\t\treturn\r\n\t\t}\r\n\t\tchannel.execCallbacks[message.id](message.data)\r\n\t\tdelete channel.execCallbacks[message.id]\r\n\t}\r\n\r\n\tthis.handlePropertyUpdate = function (message) {\r\n\t\tmessage.data.forEach((data) => {\r\n\t\t\tvar object = channel.objects[data.object]\r\n\t\t\tif (object) {\r\n\t\t\t\tobject.propertyUpdate(data.signals, data.properties)\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('Unhandled property update: ' + data.object + '::' + data.signal)\r\n\t\t\t}\r\n\t\t})\r\n\t\tchannel.exec({ type: QWebChannelMessageTypes.idle })\r\n\t}\r\n\r\n\tthis.handleModule = function (message, module) {\r\n\t\tvar object = this.objects[message.id]\r\n\t\tif (object === undefined) {\r\n\t\t\tconsole.warn('handleModule: ObjectName undefined.')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tfunction addMethod(methodData, module) {\r\n\t\t\tvar methodName = methodData[0]\r\n\t\t\tvar methodIdx = methodData[1]\r\n\r\n\t\t\tmodule[methodName] = function () {\r\n\t\t\t\tvar args = []\r\n\t\t\t\tvar callback = undefined\r\n\t\t\t\tfor (let i = 0, len = arguments.length; i < len; ++i) {\r\n\t\t\t\t\tvar argument = arguments[i]\r\n\t\t\t\t\tif (typeof argument === 'function') callback = argument\r\n\t\t\t\t\telse args.push(argument)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar idx = channel.registerCallback(callback)\r\n\r\n\t\t\t\tchannel.exec({\r\n\t\t\t\t\ttype: QWebChannelMessageTypes.invokeJSMethod,\r\n\t\t\t\t\tobject: object.__id__,\r\n\t\t\t\t\tname: methodName,\r\n\t\t\t\t\tmethod: methodIdx,\r\n\t\t\t\t\targs: args,\r\n\t\t\t\t\tcallback: idx,\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction addObject(data, target) {\r\n\t\t\tfor (const key of Object.keys(data)) {\r\n\t\t\t\tif (key === '__methods__') {\r\n\t\t\t\t\tdata.__methods__.forEach(function (methodData) {\r\n\t\t\t\t\t\taddMethod(methodData, target)\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet c = {}\r\n\t\t\t\t\ttarget[key] = c\r\n\t\t\t\t\taddObject(data[key], c)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddObject(message.module, module)\r\n\t}\r\n\r\n\tthis.modules = {}\r\n\r\n\tthis.importModule = function (url, moduleName, callback) {\r\n\t\tthis.modules[url] = {\r\n\t\t\tmodule: moduleName,\r\n\t\t\tcallback: callback,\r\n\t\t}\r\n\r\n\t\tlet core = this.objects.Core\r\n\t\tcore.importModule(url)\r\n\t}\r\n\r\n\tthis.debug = function (message) {\r\n\t\tchannel.send({ type: QWebChannelMessageTypes.debug, data: message })\r\n\t}\r\n\r\n\tchannel.exec({ type: QWebChannelMessageTypes.init }, function (data) {\r\n\t\tfor (const objectName of Object.keys(data)) {\r\n\t\t\tnew QObject(objectName, data[objectName], channel)\r\n\t\t}\r\n\r\n\t\t// now unwrap properties, which might reference other registered objects\r\n\t\tfor (const objectName of Object.keys(channel.objects)) {\r\n\t\t\tchannel.objects[objectName].unwrapProperties()\r\n\t\t}\r\n\r\n\t\tif (initCallback) {\r\n\t\t\tinitCallback(channel)\r\n\t\t}\r\n\r\n\t\tchannel.exec({ type: QWebChannelMessageTypes.idle })\r\n\t})\r\n}\r\n\r\nfunction QObject(name, data, webChannel) {\r\n\tthis.__id__ = name\r\n\twebChannel.objects[name] = this\r\n\r\n\t// List of callbacks that get invoked upon signal emission\r\n\tthis.__objectSignals__ = {}\r\n\r\n\t// Cache of all properties, updated when a notify signal is emitted\r\n\tthis.__propertyCache__ = {}\r\n\r\n\tvar object = this\r\n\r\n\t// ----------------------------------------------------------------------\r\n\r\n\tthis.unwrapQObject = function (response) {\r\n\t\tif (response instanceof Array) {\r\n\t\t\t// support list of objects\r\n\t\t\treturn response.map((qobj) => object.unwrapQObject(qobj))\r\n\t\t}\r\n\t\tif (!(response instanceof Object)) return response\r\n\r\n\t\tif (!response['__QObject*__'] || response.id === undefined) {\r\n\t\t\tvar jObj = {}\r\n\t\t\tfor (const propName of Object.keys(response)) {\r\n\t\t\t\tjObj[propName] = object.unwrapQObject(response[propName])\r\n\t\t\t}\r\n\t\t\treturn jObj\r\n\t\t}\r\n\r\n\t\tvar objectId = response.id\r\n\t\tif (webChannel.objects[objectId]) return webChannel.objects[objectId]\r\n\r\n\t\tif (!response.data) {\r\n\t\t\tconsole.error('Cannot unwrap unknown QObject ' + objectId + ' without data.')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tvar qObject = new QObject(objectId, response.data, webChannel)\r\n\t\tqObject.destroyed.connect(function () {\r\n\t\t\tif (webChannel.objects[objectId] === qObject) {\r\n\t\t\t\tdelete webChannel.objects[objectId]\r\n\t\t\t\t// reset the now deleted QObject to an empty {} object\r\n\t\t\t\t// just assigning {} though would not have the desired effect, but the\r\n\t\t\t\t// below also ensures all external references will see the empty map\r\n\t\t\t\t// NOTE: this detour is necessary to workaround QTBUG-40021\r\n\t\t\t\tObject.keys(qObject).forEach((name) => delete qObject[name])\r\n\t\t\t}\r\n\t\t})\r\n\t\t// here we are already initialized, and thus must directly unwrap the properties\r\n\t\tqObject.unwrapProperties()\r\n\t\treturn qObject\r\n\t}\r\n\r\n\tthis.unwrapProperties = function () {\r\n\t\tfor (const propertyIdx of Object.keys(object.__propertyCache__)) {\r\n\t\t\tobject.__propertyCache__[propertyIdx] = object.unwrapQObject(\r\n\t\t\t\tobject.__propertyCache__[propertyIdx]\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction addSignal(signalData, isPropertyNotifySignal) {\r\n\t\tvar signalName = signalData[0]\r\n\t\tvar signalIndex = signalData[1]\r\n\t\tobject[signalName] = {\r\n\t\t\tconnect: function (callback) {\r\n\t\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\t\tconsole.error('Bad callback given to connect to signal ' + signalName)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.__objectSignals__[signalIndex] =\r\n\t\t\t\t\tobject.__objectSignals__[signalIndex] || []\r\n\t\t\t\tobject.__objectSignals__[signalIndex].push(callback)\r\n\r\n\t\t\t\t// only required for \"pure\" signals, handled separately for properties in propertyUpdate\r\n\t\t\t\tif (isPropertyNotifySignal) return\r\n\r\n\t\t\t\t// also note that we always get notified about the destroyed signal\r\n\t\t\t\tif (\r\n\t\t\t\t\tsignalName === 'destroyed' ||\r\n\t\t\t\t\tsignalName === 'destroyed()' ||\r\n\t\t\t\t\tsignalName === 'destroyed(QObject*)'\r\n\t\t\t\t)\r\n\t\t\t\t\treturn\r\n\r\n\t\t\t\t// and otherwise we only need to be connected only once\r\n\t\t\t\tif (object.__objectSignals__[signalIndex].length == 1) {\r\n\t\t\t\t\twebChannel.exec({\r\n\t\t\t\t\t\ttype: QWebChannelMessageTypes.connectToSignal,\r\n\t\t\t\t\t\tobject: object.__id__,\r\n\t\t\t\t\t\tsignal: signalIndex,\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdisconnect: function (callback) {\r\n\t\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\t\tconsole.error('Bad callback given to disconnect from signal ' + signalName)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// This makes a new list. This is important because it won't interfere with\r\n\t\t\t\t// signal processing if a disconnection happens while emittig a signal\r\n\t\t\t\tobject.__objectSignals__[signalIndex] = (\r\n\t\t\t\t\tobject.__objectSignals__[signalIndex] || []\r\n\t\t\t\t).filter(function (c) {\r\n\t\t\t\t\treturn c != callback\r\n\t\t\t\t})\r\n\t\t\t\tif (\r\n\t\t\t\t\t!isPropertyNotifySignal &&\r\n\t\t\t\t\tobject.__objectSignals__[signalIndex].length === 0\r\n\t\t\t\t) {\r\n\t\t\t\t\t// only required for \"pure\" signals, handled separately for properties in propertyUpdate\r\n\t\t\t\t\twebChannel.exec({\r\n\t\t\t\t\t\ttype: QWebChannelMessageTypes.disconnectFromSignal,\r\n\t\t\t\t\t\tobject: object.__id__,\r\n\t\t\t\t\t\tsignal: signalIndex,\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tthen: function (callback) {\r\n\t\t\t\tthis.connect(callback)\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Invokes all callbacks for the given signalname. Also works for property notify callbacks.\r\n\t */\r\n\tfunction invokeSignalCallbacks(signalName, signalArgs) {\r\n\t\tvar connections = object.__objectSignals__[signalName]\r\n\t\tif (connections) {\r\n\t\t\tconnections.forEach(function (callback) {\r\n\t\t\t\tcallback.apply(callback, signalArgs)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tthis.propertyUpdate = function (signals, propertyMap) {\r\n\t\t// update property cache\r\n\t\tfor (const propertyIndex of Object.keys(propertyMap)) {\r\n\t\t\tvar propertyValue = propertyMap[propertyIndex]\r\n\t\t\tobject.__propertyCache__[propertyIndex] = this.unwrapQObject(propertyValue)\r\n\t\t}\r\n\r\n\t\tfor (const signalName of Object.keys(signals)) {\r\n\t\t\t// Invoke all callbacks, as signalEmitted() does not. This ensures the\r\n\t\t\t// property cache is updated before the callbacks are invoked.\r\n\t\t\tinvokeSignalCallbacks(signalName, signals[signalName])\r\n\t\t}\r\n\t}\r\n\r\n\tthis.signalEmitted = function (signalName, signalArgs) {\r\n\t\tinvokeSignalCallbacks(signalName, this.unwrapQObject(signalArgs))\r\n\t}\r\n\r\n\tfunction addMethod(methodData) {\r\n\t\tvar methodName = methodData[0]\r\n\t\tvar methodIdx = methodData[1]\r\n\r\n\t\t// Fully specified methods are invoked by id, others by name for host-side overload resolution\r\n\t\tvar invokedMethod = methodName[methodName.length - 1] === ')' ? methodIdx : methodName\r\n\r\n\t\tobject[methodName] = function () {\r\n\t\t\tvar args = []\r\n\t\t\tvar callback = undefined\r\n\t\t\tvar errCallback\r\n\t\t\tfor (var i = 0; i < arguments.length; ++i) {\r\n\t\t\t\tvar argument = arguments[i]\r\n\t\t\t\tif (typeof argument === 'function') callback = argument\r\n\t\t\t\telse args.push(argument)\r\n\t\t\t}\r\n\r\n\t\t\tvar hasCallback = callback !== undefined\r\n\r\n\t\t\tvar result\r\n\t\t\t// during test, webChannel.exec synchronously calls the callback\r\n\t\t\t// therefore, the promise must be constucted before calling\r\n\t\t\t// webChannel.exec to ensure the callback is set up\r\n\t\t\tif (!callback && typeof Promise === 'function') {\r\n\t\t\t\tresult = new Promise(function (resolve, reject) {\r\n\t\t\t\t\tcallback = resolve\r\n\t\t\t\t\terrCallback = reject\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\twebChannel.exec(\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: QWebChannelMessageTypes.invokeMethod,\r\n\t\t\t\t\tobject: object.__id__,\r\n\t\t\t\t\tmethod: invokedMethod,\r\n\t\t\t\t\targs: args,\r\n\t\t\t\t\tcallback: hasCallback,\r\n\t\t\t\t},\r\n\t\t\t\tfunction (response) {\r\n\t\t\t\t\tif (response !== undefined) {\r\n\t\t\t\t\t\tvar result = object.unwrapQObject(response)\r\n\t\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\t\tcallback(result)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (errCallback) {\r\n\t\t\t\t\t\terrCallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\r\n\t\t\treturn result\r\n\t\t}\r\n\t}\r\n\r\n\tfunction bindGetterSetter(propertyInfo) {\r\n\t\tvar propertyIndex = propertyInfo[0]\r\n\t\tvar propertyName = propertyInfo[1]\r\n\t\tvar notifySignalData = propertyInfo[2]\r\n\t\t// initialize property cache with current value\r\n\t\t// NOTE: if this is an object, it is not directly unwrapped as it might\r\n\t\t// reference other QObject that we do not know yet\r\n\t\tobject.__propertyCache__[propertyIndex] = propertyInfo[3]\r\n\r\n\t\tif (notifySignalData) {\r\n\t\t\tif (notifySignalData[0] === 1) {\r\n\t\t\t\t// signal name is optimized away, reconstruct the actual name\r\n\t\t\t\tnotifySignalData[0] = propertyName + 'Changed'\r\n\t\t\t}\r\n\t\t\taddSignal(notifySignalData, true)\r\n\t\t}\r\n\r\n\t\tObject.defineProperty(object, propertyName, {\r\n\t\t\tconfigurable: true,\r\n\t\t\tget: function () {\r\n\t\t\t\tvar propertyValue = object.__propertyCache__[propertyIndex]\r\n\t\t\t\tif (propertyValue === undefined) {\r\n\t\t\t\t\t// This shouldn't happen\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t'Undefined value in property cache for property \"' +\r\n\t\t\t\t\t\t\tpropertyName +\r\n\t\t\t\t\t\t\t'\" in object ' +\r\n\t\t\t\t\t\t\tobject.__id__\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn propertyValue\r\n\t\t\t},\r\n\t\t\tset: function (value) {\r\n\t\t\t\tif (value === undefined) {\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t'Property setter for ' + propertyName + ' called with undefined value!'\r\n\t\t\t\t\t)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tobject.__propertyCache__[propertyIndex] = value\r\n\t\t\t\tvar valueToSend = value\r\n\t\t\t\twebChannel.exec({\r\n\t\t\t\t\ttype: QWebChannelMessageTypes.setProperty,\r\n\t\t\t\t\tobject: object.__id__,\r\n\t\t\t\t\tproperty: propertyIndex,\r\n\t\t\t\t\tvalue: valueToSend,\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\r\n\t// ----------------------------------------------------------------------\r\n\r\n\tdata.methods.forEach(addMethod)\r\n\r\n\tdata.properties.forEach(bindGetterSetter)\r\n\r\n\tdata.signals.forEach(function (signal) {\r\n\t\taddSignal(signal, false)\r\n\t})\r\n\r\n\tObject.assign(object, data.enums)\r\n}\r\n\r\nQObject.prototype.toJSON = function () {\r\n\tif (this.__id__ === undefined) return {}\r\n\treturn {\r\n\t\tid: this.__id__,\r\n\t\t'__QObject*__': true,\r\n\t}\r\n}\r\n\r\nexport default function SSWebChannel(element, callback) {\r\n\tvar mouseDown = false\r\n\tvar mousePosition = { x: 0, y: 0 }\r\n\tvar core\r\n\r\n\tfunction getPosition(element, event, result) {\r\n\t\tif (element === document) {\r\n\t\t\tresult.x = event.clientX\r\n\t\t\tresult.y = event.clientY\r\n\t\t\treturn result\r\n\t\t}\r\n\r\n\t\tvar rect = element.getBoundingClientRect()\r\n\t\tresult.x = event.clientX - rect.left\r\n\t\tresult.y = event.clientY - rect.top\r\n\t\treturn result\r\n\t}\r\n\r\n\tfunction registerListener(domType, element, callback) {\r\n\t\tfunction listener(e) {\r\n\t\t\t// console.log(domType);\r\n\t\t\tcallback(element, e)\r\n\t\t}\r\n\r\n\t\telement.addEventListener(domType, listener, {\r\n\t\t\tcapture: false,\r\n\t\t\tpassive: true,\r\n\t\t})\r\n\r\n\t\tconsole.log('registerListener ' + domType)\r\n\t}\r\n\r\n\tfunction getChangedTouches(element, event) {\r\n\t\tvar list = []\r\n\t\tvar changedTouches = event.changedTouches\r\n\t\tfor (let i = 0, len = changedTouches.length; i < len && i < 2; ++i) {\r\n\t\t\tlet touch = changedTouches[i]\r\n\t\t\tlet position = getPosition(element, touch, mousePosition)\r\n\t\t\tlist.push({\r\n\t\t\t\tid: touch.identifier,\r\n\t\t\t\tx: position.x,\r\n\t\t\t\ty: position.y,\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn list\r\n\t}\r\n\r\n\tfunction handleTouchStart(element, event) {\r\n\t\tmouseDown = true\r\n\t\tlet list = getChangedTouches(element, event)\r\n\t\tcore.touchStart(list)\r\n\t}\r\n\r\n\tvar lastMove = 0\r\n\tvar lastHour = -1\r\n\r\n\tfunction handleTouchMove(element, event) {\r\n\t\tif (mouseDown) {\r\n\t\t\tlet t = new Date()\r\n\t\t\tlet hour = t.getHours()\r\n\t\t\tif (lastHour > hour) {\r\n\t\t\t\tlastMove = 0\r\n\t\t\t}\r\n\t\t\tlet current =\r\n\t\t\t\thour * (60 * 60) +\r\n\t\t\t\tt.getMinutes() * 60 +\r\n\t\t\t\tt.getSeconds() +\r\n\t\t\t\tt.getMilliseconds() * 1e-3\r\n\t\t\tif (current - lastMove > 1.0 / 20.0) {\r\n\t\t\t\tlastMove = current\r\n\t\t\t\tlastHour = hour\r\n\t\t\t\tlet list = getChangedTouches(element, event)\r\n\t\t\t\tcore.touchMove(list)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handleTouchEnd(element, event) {\r\n\t\tif (mouseDown) {\r\n\t\t\tlet list = getChangedTouches(element, event)\r\n\t\t\tcore.touchEnd(list)\r\n\t\t}\r\n\t\tmouseDown = false\r\n\t}\r\n\r\n\tvar socket = new WebChannelSocket()\r\n\r\n\twindow.webChannelSocket = socket\r\n\r\n\tsocket.onclose = function () {\r\n\t\tconsole.error('web channel closed')\r\n\t}\r\n\tsocket.onerror = function (error) {\r\n\t\tconsole.error('web channel error: ' + error)\r\n\t}\r\n\tsocket.onopen = function () {\r\n\t\tconsole.log('socket is openning')\r\n\t\tnew QWebChannel(socket, function (channel) {\r\n\t\t\t// make core object accessible globally\r\n\t\t\tcore = channel.objects.Core\r\n\r\n\t\t\tvar viewer = {}\r\n\t\t\tviewer.listeners = {}\r\n\t\t\tviewer.listeners['update'] = []\r\n\t\t\twindow.GlobalViewer = viewer\r\n\r\n\t\t\tviewer.addEventListener = (type, callback) => {\r\n\t\t\t\tif (type === 'update') {\r\n\t\t\t\t\tviewer.listeners['update'].push(callback)\r\n\t\t\t\t\tcore.frameUpdate.connect(callback)\r\n\t\t\t\t\treturn callback\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tviewer.removeEventListener = (listener) => {\r\n\t\t\t\tlet listeners = viewer.listeners['update']\r\n\t\t\t\tlet index = listeners.indexOf(listener)\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tcore.frameUpdate.disconnect(listener)\r\n\t\t\t\t\tlisteners.splice(index, 1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tviewer.onNativeNotify = (callback) => {\r\n\t\t\t\tcore.nativeNotify.connect((data) => {\r\n\t\t\t\t\tcallback(data)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tcore.outputMessage.connect((msg) => {\r\n\t\t\t\tconsole.log(msg)\r\n\t\t\t})\r\n\r\n\t\t\tcore.moduleLoaded.connect((url, data) => {\r\n\t\t\t\tlet moduleData = channel.modules[url]\r\n\t\t\t\tlet moduleName = moduleData.module\r\n\t\t\t\tlet callback = moduleData.callback\r\n\r\n\t\t\t\tlet module\r\n\t\t\t\tif (!moduleName || moduleName === '') {\r\n\t\t\t\t\tmodule = window\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (window[moduleName] === undefined) {\r\n\t\t\t\t\t\twindow[moduleName] = {}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmodule = window[moduleName]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tchannel.handleModule(data, module)\r\n\r\n\t\t\t\tif (callback) {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('module loaded: ' + url)\r\n\t\t\t})\r\n\r\n\t\t\tcore.nativeCallback.connect((message) => {\r\n\t\t\t\tlet callback = channel.execCallbacks[message.callback]\r\n\t\t\t\tif (!callback) {\r\n\t\t\t\t\tconsole.error('Invalid response message received: ', JSON.stringify(message))\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcallback(message.data)\r\n\t\t\t\t// delete channel.execCallbacks[message.callback];\r\n\t\t\t})\r\n\r\n\t\t\telement.onmouseover = () => {\r\n\t\t\t\tcore.mouseOverCanvas()\r\n\t\t\t}\r\n\r\n\t\t\telement.onmouseout = () => {\r\n\t\t\t\tcore.mouseOutCanvas()\r\n\t\t\t}\r\n\r\n\t\t\telement.onfocus = () => {\r\n\t\t\t\tcore.onFocus()\r\n\t\t\t}\r\n\r\n\t\t\telement.onblur = () => {\r\n\t\t\t\tcore.onBlur()\r\n\t\t\t}\r\n\r\n\t\t\tregisterListener('touchstart', element, handleTouchStart)\r\n\t\t\tregisterListener('touchmove', element, handleTouchMove)\r\n\t\t\tregisterListener('touchend', element, handleTouchEnd)\r\n\t\t\tregisterListener('touchcancel', element, handleTouchEnd)\r\n\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(channel)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tsocket.onopen()\r\n}\r\n"],"mappings":"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","ignoreList":[]}]}