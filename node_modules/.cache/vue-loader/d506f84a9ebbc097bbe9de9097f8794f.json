{"remainingRequest":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\src\\components\\map\\map.vue?vue&type=template&id=49cee7c9&ts=true","dependencies":[{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\src\\components\\map\\map.vue","mtime":1747362446458},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747302828451},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\babel-loader\\lib\\index.js","mtime":1747302829587},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\ts-loader\\index.js","mtime":1747302829764},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1747302830655},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747302828451},{"path":"C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1747302829861}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICA8ZGl2PgogICAgICAgPGRpdiBpZD0iY2VzaXVtQ29udGFpbmVyIj48L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0iY3JlZGl0IiBzdHlsZT0iZGlzcGxheTpub25lIj48L2Rpdj4KICAgCiAgICA8L2Rpdj4K"},{"version":3,"sources":["C:\\Program Files\\TaiChiWorkSpace\\数字孪生—智慧广州\\code\\src\\components\\map\\map.vue"],"names":[],"mappings":";IAEI,CAAC,CAAC,CAAC,CAAC;OACD,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;QAE9B,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE/C,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Program Files/TaiChiWorkSpace/数字孪生—智慧广州/code/src/components/map/map.vue","sourceRoot":"","sourcesContent":["<!-- 加载视频流组件 -->\n<template>\n    <div>\n       <div id=\"cesiumContainer\"></div>\n\n        <div id=\"credit\" style=\"display:none\"></div>\n   \n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport * as Cesium from 'cesium';\nimport '../../Widgets/widgets.css'\nimport { onMounted } from 'vue';\n// 设置cesium的静态资源路径\nwindow.CESIUM_BASE_URL = '/cesium'\nonMounted(()=>{\nconst basemapProvider = new Cesium.UrlTemplateImageryProvider({\n  url: 'https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/imagery/WGS84/{z}/{x}/{y}.png',\n  credit: \"© Map from Lands Department\"\n});\nconst viewer = new Cesium.Viewer('cesiumContainer', {\n  baseLayer: new Cesium.ImageryLayer(basemapProvider),\n  baseLayerPicker: false,\n  timeline: false,\n  animation: false,\n  vrButton: false,\n  fullscreenButton: false,\n  homeButton: false,\n  navigationHelpButton: false,\n  geocoder: false,\n  sceneModePicker: false,\n  requestRenderMode: true,\n  creditContainer: \"credit\",\n});\n\nconst addLayer = async() =>{\n  let tileset = await Cesium.Cesium3DTileset.fromUrl(\n    'https://data.map.gov.hk/api/3d-data/3dtiles/f2/tileset.json?key=3967f8f365694e0798af3e7678509421'\n  );\n  viewer.scene.primitives.add(tileset);\n}\n\naddLayer();\n\nviewer.camera.flyTo({\n  destination: Cesium.Cartesian3.fromDegrees(\n    114.158798, // 中环经度\n    22.281931,  // 中环纬度\n    2000        // 高度2000米\n  ),\n  orientation: {\n    heading: 0,             // 正北\n    pitch: -Cesium.Math.PI_OVER_FOUR, // -45度向下俯视\n    roll: 0\n  },\n  duration: 0\n});\n\nfunction flyThrough() {\n  const currentState = 'stopped' === document.getElementById(\"fly\").className ? 'playing' : 'stopped';\n  document.getElementById(\"fly\").className = currentState;\n  viewer.scene.screenSpaceCameraController.enableInputs = false;\n  if('playing' === currentState) {\n    viewer.camera.flyTo({\n      destination: {\n        x: -2422424.2445589276,\n        y: 5384032.397876303,\n        z: 2405707.0615597237\n      },\n      orientation: {\n        heading: 5.6200000366324705,\n        pitch: -0.32032049944881735,\n        roll: 6.283175543034232\n      },\n      complete: function() {\n        const distance = Cesium.Cartesian3.distance(\n          new Cesium.Cartesian3.fromDegrees(114.214374, 22.315202),\n          new Cesium.Cartesian3.fromDegrees(114.22428750237164, 22.304629162175697)\n        );\n        const startTime = Cesium.JulianDate.fromDate(new Date());\n        const stopTime = Cesium.JulianDate.addSeconds(\n          startTime,\n          distance,\n          new Cesium.JulianDate()\n        );\n        const property = new Cesium.SampledPositionProperty();\n        let time = Cesium.JulianDate.addSeconds(\n          startTime,\n          0,\n          new Cesium.JulianDate()\n        );\n        let position = Cesium.Cartesian3.fromDegrees(\n          114.22428750237164,\n          22.304629162175697,\n          132.02238802935133\n        );\n        property.addSample(time, position);\n        time = Cesium.JulianDate.addSeconds(\n          startTime,\n          distance,\n          new Cesium.JulianDate()\n        );\n        position = Cesium.Cartesian3.fromDegrees(\n          114.214374,\n          22.315202,\n          132.02238802935133\n        );\n        property.addSample(time, position);\n        let entity = {\n          availability: new Cesium.TimeIntervalCollection([\n            new Cesium.TimeInterval({\n              start: startTime,\n              stop: stopTime,\n            }),\n          ]),\n          position: property,\n        };\n        entity.position.setInterpolationOptions({\n          interpolationDegree: 2,\n          interpolationAlgorithm: Cesium.HermitePolynomialApproximation,\n        });\n\n        viewer.clock.startTime = startTime.clone();\n        viewer.clock.stopTime = stopTime.clone();\n        viewer.clock.currentTime = startTime.clone();\n        viewer.clock.clockRange = Cesium.ClockRange.LOOP_STOP;\n        viewer.clock.multiplier = 50;\n        viewer.clock.shouldAnimate = true;\n        viewer.camera.position = new Cesium.Cartesian3(0.25, 0, 5);\n        viewer.camera.direction = new Cesium.Cartesian3(-1.25, 1.6, -0.6725);\n        viewer.camera.up = new Cesium.Cartesian3(0.0, 0.0, 1.0);\n        viewer.camera.right = new Cesium.Cartesian3(0.0, -1.0, 0.0);\n\n        viewer.scene.postUpdate.addEventListener(function (scene, time) {\n          if(viewer.clock.shouldAnimate) {\n            viewer.scene.screenSpaceCameraController.enableInputs = false;\n            const position = entity.position.getValue(time);\n            if (!Cesium.defined(position)) {\n              return;\n            }\n            let transform;\n            if (!Cesium.defined(entity.orientation)) {\n              transform = Cesium.Transforms.eastNorthUpToFixedFrame(position);\n            }\n            const offset = Cesium.Cartesian3.clone(viewer.camera.position);\n            const direction = Cesium.Cartesian3.clone(viewer.camera.direction);\n            const up = Cesium.Cartesian3.clone(viewer.camera.up);\n            viewer.camera.lookAtTransform(transform);\n            Cesium.Cartesian3.clone(offset, viewer.camera.position);\n            Cesium.Cartesian3.clone(direction, viewer.camera.direction);\n            Cesium.Cartesian3.clone(up, viewer.camera.up);\n            Cesium.Cartesian3.cross(direction, up, viewer.camera.right);\n          } else {\n            viewer.scene.postUpdate._listeners.pop();\n            viewer.entities.remove(entity);\n            viewer.clock.clockRange = 0;\n            viewer.clock.multiplier = 1;\n            viewer.clock.currentTime = Cesium.JulianDate.fromDate(new Date());\n            viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\n            viewer.camera.flyTo({\n              destination: Cesium.Cartesian3.fromDegrees(\n                114.21918297929119,\n                22.237495624660887,\n                4999.9999999995025\n              ),\n              orientation: {\n                heading: 6.283185307179586,\n                pitch: -0.5251224807670001,\n                roll: 6.283185307179585,\n              }\n            });\n          }\n        })\n      }\n    })\n  } else {\n    viewer.clock.shouldAnimate = false;\n    viewer.scene.screenSpaceCameraController.enableInputs = true;\n  }\n}\n})\n</script>\n<style lang=\"scss\" scoped>\n\n</style>\n"]}]}